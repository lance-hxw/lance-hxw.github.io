# db per service
每个服务有独立的数据库实例/schema, 不跨服务访问
- 注意不是单纯开不同的表, 至少也是schema不同

这里强调的是隔离性,或者说解耦合, 即一组数据只能一个服务去访问:
- 即实例级别或者schema级别(如database)隔离
- 实例级隔离可以避免资源占用的影响
- schema级别的隔离可以防止意外使用其他服务的表
- 可以免除复杂权限管理
- 可以方便修改全局配置不影响其他服务


## shared db
多个服务访问同一个数据库, 通常不推荐,只能迁移期或者低隔离需求使用

但是实际上这是被多数采用的方式, 因为db per srv 的运维和成本压力很大

# saga 模式
将分布式事务拆分成一系列局部事务, 通过正向或者补偿事务保持一致性
- 编排式: saga协调器控制流程
- 编舞式: 各个服务各自监听实践, 触发下一步
# 2pc
使用XA等协议在多数据库间强一致性提交, 性能太差

# CQRS, 命令和查询 分离
将写(command)和读(query)拆分, 使用不同的存储或者模式优化性能
# 事件源
将所有状态变更用事件流进行持久化, 状态可以用事件流重放生成
- 优点: 完整的状态审计
- 缺点: 事件需要存储, 版本管理复杂

