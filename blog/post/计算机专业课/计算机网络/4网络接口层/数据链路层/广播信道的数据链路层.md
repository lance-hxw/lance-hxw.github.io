## 局域网的数据链路层

- 早期，局域网有更高的数据率，低时延和低误码率，但随光纤使用，广域网也可以了。。

**局域网特点：**

- 有广播功能，从一个站点可以方便访问全网，局域网主机可以共享连接在局域网上的各种硬件和软件资源。
- 便于系统扩展和逐渐演变，每个设备的位置可以灵活调整和改变。
- 提高了系统的可靠性，可用性和生存性。

### 局域网的拓扑结构：

- 星形网--集线器的应用与双绞线，星形以太网和多级星形结构以太网。
- 环形网
- 总线网--传统

### 共享信道的方式：

- 静态划分信道：先验规划，如TDM，FDM，CDM。但开销大，不适合局域网
- 动态媒体接入控制：多点接入
    - **随机接入**，用户随机发送，可能产生碰撞（同时发送）
    - 受控接入，轮询等。

### 以太网的两个标准

IEEE 802委员会将局域网的数据链路层拆分为两个子层：

- 逻辑链路控制LLC
- 媒体接入控制MAC，与接入到传输媒体有关的内容都在MAC子层

LLC与MAC无关，是MAC之上的子层，无论使用何种MAC子层，对LLC都是透明的。

随着时代发展，当时指定的以太网标准已经被DIX Ethernet V2取代（只剩）
此时LLC已经失去了作用，故现在只剩下MAC协议。

### 适配器的作用

计算机与外界局域网连接是通过适配器的（网卡）。

适配器与局域网通过双绞线之类的串行连接，而适配器与主板通过IO总线并行传输，所以适配器的重要功能就是进行串行和并行的转换。同时要带有缓存和驱动。

当适配器抛弃帧时不通知cpu，接受一个帧时，发出中断，上交网络层。

计算机的**硬件地址**保存在适配器ROM中，但**软件地址--IP**，在计算机的存储器中记录。

## CSMA/CD 协议

载波监听多点接入/碰撞检测
- 截断二进制指数退避
- 强化碰撞

### 特点

- 多点接入：总线网络
- 载波监听：边发送边监听，这里载波可以叫媒体。无论何时，每个主机都要不停检测信道。
- 碰撞检测：若发现有其他站点在发送，就中断自己的发送。

即使检测信道为空，开始发送后也会面临冲突，因为传播时延不可忽略。

- 不能全双工--自己不能同时接/发，只能半双工
- 

## 使用集线器的星形拓扑

使用粗同轴电缆的传统以太网演进为使用简单双绞线，此时变为星形拓扑，在中心有一个高可靠性的集线器。
双绞线以太网总是和集线器一起使用。

### 集线器的特点：

- 使用集线器的局域网物理上是星形网络，但是集线器用电子器件模拟电缆，使得整个系统像一个传统以太网（总线网）运行。即在逻辑上是总线网，各站共享逻辑上的总线，使用CSMA/CD协议（适配器执行此协议）。网络中各站必须竞争对传输媒体的控制，在同一时刻至多运行一个站发送数据。
- 一个集线器有多个端口。每个端口用两对双绞线与一台适配器相连，就像一个多端口的转发器。
- 集线器工作在**物理层**。他的端口仅转发bit，不进行碰撞检测，如果多个端口同时输入，则所有端口都收不到正确帧。
- 集线器使用专门的芯片，进行自适应串音回波抵消

集线器有高可靠性，若有端口出现问题，可以进行一定程度的修正。

## 以太网的信道利用率

## 以太网的MAC层

### MAC地址

硬件地址/物理地址/MAC地址

 “名字指出寻找的那个资源，地址指出他在何处，路由告诉我们如何到达此处”
 
 相较于这个句子，更严格的说，名字与系统的位置没有关系，所以IEEE802标准为局域网规定了一种48位的全球地址，这是固化在适配器ROM中的地址。那么：
 - 如果计算机上的适配器被更换了，那么计算机的为物理地址就变了。
 - 只要不更换适配器，在不同局域网中的地址是相同的。
 
那么，这个**地址**不能指出主机的具体位置，反而接近**名字**的定义（或者说标识符）。（但是这个48位的名字在直觉上像一个地址）
如果一个主机有多个适配器，那么他就有多个地址。那么他进一步被解释为：某个接口的标识符。

#### 地址的组成

MAC地址可以是6B或者2B，现在一般都是6B。
IEEE的注册管理机构RA是局域网全球地址的法定管理机构，他负责分配前3个Byte，即OUI，组织唯一标识符，又称公司标识符。生产适配器的公司都需要购买OUI，而后三个Byte由厂家指定，于是一个OUI可衍生大量MAC地址，这又称为EUI-48。

- IEEE规定地址字段的第一BYTE的最低有效位为I/G位（Individual/Group）,若为0，表示一个单个站地址，否则表示一个组地址。

注意，如果把**最高位**放在Byte最左边，传输时就先传最高位，否则传最低位，即传输按照字节内顺序。

- 考虑到有人不想买OUI，第一BYTE最低第二位为Global/Local, 为1时为本地管理，此时可以任意分配网络上的地址（若为2B的MAC地址，全是Local），但是以太网一般不理会这个位。

综上，共有46位可用于地址编址。
