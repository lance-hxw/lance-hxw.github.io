# IPv6

具有更大的地址空间

## 变化

- 更大的地址空间，从32bit到128bit
- 扩展的地址层次结构，可以划分更多层次，而不只有两层
- 灵活的首部格式，v4和v6的首部格式不兼容；提供了更多的扩展字段
- ipv6首部长度固定，而选项可以放在有效载荷中
- 允许协议扩充，而不是像4一样固定
- 自动配置，不需要DHCP
- 资源预分配，支持一些，需要保证带宽和时延的应用
- 8B对齐，首部长度必须是8B的整数倍，原来是4B对齐

## 格式

基本首部和有效载荷（净值）

基本首部40B，在有效载荷中可以有扩展首部

有效载荷不超过65535B

### 格式变化

- 没有首部长度，因为固定
- 没有服务类型，用优先级和流标
- 没有总长度，用有效载荷长度
- 没有标志，标识，偏移，改为扩展首部
- TTL变跳数限制
- 没有协议字段，改用下一个首部字段
- 没有校验和，让UDP，TCP等处理
- 没有选项，用扩展首部

## 地址

- 单播，广播，任播（终点一组主机，但只有一个最优的接受）
- 不再使用点分十进制，而是冒号十六进制，可以忽略前导0，即零压缩
- 没有子网掩码


## 向ipv6过度

- 只能逐步演进，需要向后兼容，即需要6能接受4的分组，并进行路由分配
- 双协议栈，隧道技术

### 双协议栈

主机安装两个协议栈，在对不同主机通信时，使用不同的协议栈

### 隧道技术

在v6的数据报进入v4网络时，将v6数据报封装为v4数据报，这样就相当于为v6数据报在v4网络中开了一条隧道，过程中没有其他麻烦，只要进行两次转换即可。

在隧道中，源头和目标地址是v4网络的进出口。

