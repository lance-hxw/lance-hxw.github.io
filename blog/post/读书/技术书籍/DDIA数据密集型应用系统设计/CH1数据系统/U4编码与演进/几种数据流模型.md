即几种进程间的数据流类型:
- 通过数据库进行
- 通过服务调用
- 通过异步消息传递
# 通过数据库进行传递

# 通过服务调用: REST 与 RPC
此场景涉及两个角色: server 和 client
一般情况下, 暴露在公网的服务是 HTTP的, RPC在内网使用
一个服务可以同时是server和client, 可能需要访问其他服务或者数据库

server和数据库有点相似, 不过server只提供指定的api和服务, 而数据库支持灵活的查询语言client

## (http)web server
如果用http作为通讯协议, 一般都称为web服务, 但是往往不局限于支撑web app, 还可以:
- c端app用http请求server
- 同组织服务间通讯用http进行rpc
- 不同组织的服务进行数据交换, 如Oauth
一般http api设计有两个范式: rest 和soap
- REST是一种思想, 即一切皆资源, 然后使用动作操作资源
	-  但是纯post或者get/post也很常见
	- REST往往难以落地, 难点在抽象和设计
- SOAP,基于XML, 虽然用HTTP但是独立于HTTP, 用的少
## RPC的问题
- 本地函数调用是要么成功或者失败的, 但是RPC存在网络问题, 会丢失请求, 丢失回复, 超时等, 需要容错(重试)
- 重试时, 需要考虑幂等性
- 网络影响很大, 延迟敏感
- 系统间,尤其是不同语言实现的系统间 ,可能存在数据类型不一致, 甚至一方缺少, 此时需要严格制订api
不过网络问题不是说只有RPC才有, REST也有, 但是RPC会让人忘记这是个 网络请求, 从而写出低效且有隐患的代码

## RPC实践
对于这些缺点:
- RPC用在内网, 网络稳定快速可控
- 可能重试的接口设计好幂等性
- 跨语言使用RPC框架的IDL语言(如proto buf的proto)定义接口和类型
这些实践让RPC工程可用, 但是不能忽这些问题
RPC最大的优点是基于二进制的RPC实现效率比较高, , 不过耦合度一般比较高, 不方便升级和复用

## 数据编码和RPC演化

基于服务调用的数据流可以 假设:
- 数据在服务端更新
- 客户端访问服务端, 更新数据

所以此类数据流的演化需要:
- 在请求中考虑后向兼容(client用老格式请求新服务)
- 在响应中考虑前向兼容(client接受老数据)

不过一般情况下, RPC的兼容性都不太好, 一般需要SDK更新, 但是client的SDK不受控制, 用户不更新就会不兼容, 这需要综合考量

- thrift, gRPC(protobuf) 等, 需要考虑编码格式的兼容性
- REST处理这个就很方便, 直接把版本写到URL或者请求头中
	- 而数据是json, 直接增改字段
# 通过消息传递
#TODO 